{% macro user_avatar(user, size='sm', show_name=True) %}
<div class="flex items-center gap-2 group" title="{{ user.status_message or user.role|capitalize }}">
    <div class="relative">
        <div
            class="{{ 'w-8 h-8' if size == 'sm' else 'w-10 h-10' }} rounded-full bg-gray-100 flex items-center justify-center text-xs font-bold text-gray-600 overflow-hidden ring-2 ring-white shadow-sm border border-gray-100">
            {% if user.profile_image %}
            <img src="{{ url_for('static', filename='uploads/profiles/' + user.profile_image) }}" alt="{{ user.name }}"
                class="w-full h-full object-cover">
            {% else %}
            {{ user.name[:2].upper() }}
            {% endif %}
        </div>
        {% if user.status_message %}
        <span class="absolute -bottom-0.5 -right-0.5 w-2.5 h-2.5 bg-green-500 border-2 border-white rounded-full"
            title="Status definido"></span>
        {% endif %}
    </div>
    {% if show_name %}
    <div class="flex flex-col">
        <span class="text-sm font-medium text-gray-900 leading-tight">{{ user.name }}</span>
        {% if user.status_message %}
        <span class="text-[10px] text-gray-400 max-w-[120px] truncate hidden group-hover:block transition-all">{{
            user.status_message }}</span>
        {% endif %}
    </div>
    {% endif %}
</div>
{% endmacro %}