{% extends "base.html" %}

{% block content %}
<div class="flex-1 h-screen overflow-y-auto bg-gray-100 p-8">
    <header class="mb-8">
        <h1 class="text-3xl font-bold text-gray-900">Meu Perfil</h1>
        <p class="text-gray-500 mt-1">Gerencie suas informa√ß√µes pessoais e de acesso.</p>
    </header>

    <div class="max-w-2xl">
        <div class="bg-white rounded-lg shadow-sm border border-gray-100 overflow-hidden">
            <div class="p-8">
                <form action="{{ url_for('admin.profile') }}" method="POST" enctype="multipart/form-data"
                    class="space-y-6">

                    <!-- Profile Photo -->
                    <div class="flex items-center gap-6">
                        <div class="relative group">
                            <div class="w-24 h-24 rounded-full overflow-hidden bg-gray-100 ring-4 ring-white shadow-md">
                                {% if user.profile_image %}
                                <img src="{{ url_for('static', filename='uploads/profiles/' + user.profile_image) }}"
                                    alt="Profile" class="w-full h-full object-cover">
                                {% else %}
                                <div
                                    class="w-full h-full flex items-center justify-center bg-northway-red text-white text-3xl font-bold">
                                    {{ user.name[:2].upper() }}
                                </div>
                                {% endif %}

                                <!-- Overlay for upload -->
                                <label for="profile_image"
                                    class="absolute inset-0 bg-black/50 flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity cursor-pointer">
                                    <i data-lucide="camera" class="w-8 h-8 text-white"></i>
                                </label>
                            </div>
                        </div>
                        <div>
                            <label for="profile_image" class="block text-sm font-medium text-gray-700">Foto de
                                Perfil</label>
                            <input type="file" name="profile_image" id="profile_image" accept="image/*" class="hidden"
                                onchange="document.getElementById('file-chosen').textContent = this.files[0].name">
                            <button type="button" onclick="document.getElementById('profile_image').click()"
                                class="mt-1 text-sm text-northway-red font-bold hover:text-red-700">
                                Alterar foto
                            </button>
                            <span id="file-chosen" class="ml-2 text-xs text-gray-500"></span>
                            <p class="text-xs text-gray-500 mt-1">JPG, PNG ou GIF. Max 2MB.</p>
                        </div>
                    </div>

                    <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                        <!-- Name (Read-only for now or editable?) -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nome Completo</label>
                            <input type="text" value="{{ user.name }}"
                                class="w-full bg-gray-50 border border-gray-200 rounded px-3 py-2 text-gray-500 cursor-not-allowed"
                                readonly>
                            <p class="text-xs text-gray-400 mt-1">Para alterar o nome, contate um administrador.</p>
                        </div>

                        <!-- Email -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" value="{{ user.email }}"
                                class="w-full bg-gray-50 border border-gray-200 rounded px-3 py-2 text-gray-500 cursor-not-allowed"
                                readonly>
                        </div>

                        <!-- Phone -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Telefone / WhatsApp</label>
                            <input type="text" name="phone" value="{{ user.phone or '' }}" placeholder="(00) 00000-0000"
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-northway-red">
                        </div>

                        <!-- Role -->
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Cargo</label>
                            <div class="px-3 py-2 border border-gray-200 rounded bg-gray-50 text-gray-600">
                                {{ user.role|capitalize }}
                            </div>
                        </div>
                    </div>

                    <!-- Status Message -->
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Frase de Status</label>
                        <input type="text" name="status_message" value="{{ user.status_message or '' }}"
                            placeholder="Ex: Focado em fechar neg√≥cios üöÄ"
                            class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-northway-red">
                        <p class="text-xs text-gray-500 mt-1">Essa frase aparecer√° no seu perfil para os outros
                            usu√°rios.</p>
                    </div>

                    <div class="border-t border-gray-100 pt-6"></div>

                    <!-- Change Password -->
                    <div>
                        <h3 class="text-lg font-bold text-gray-900 mb-4">Seguran√ßa</h3>
                        <div>
                            <label class="block text-sm font-medium text-gray-700 mb-1">Nova Senha</label>
                            <input type="password" name="new_password" placeholder="Deixe em branco para manter a atual"
                                class="w-full border border-gray-300 rounded px-3 py-2 focus:outline-none focus:border-northway-red">
                        </div>
                    </div>

                    <div class="flex justify-end pt-4">
                        <button type="submit"
                            class="bg-northway-red text-white px-6 py-2 rounded-lg font-bold hover:bg-red-700 shadow-sm transition-colors">
                            Salvar Altera√ß√µes
                        </button>
                    </div>

                </form>
            </div>
        </div>
    </div>
</div>
{% endblock %}